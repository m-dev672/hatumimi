schemaVersion: 2.2.0
metadata:
  name: nanitoru
components:
  - name: devtools
    container:
      image: quay.io/devfile/universal-developer-image:latest
      endpoints:
        - name: dev-server
          exposure: public
          protocol: http
          secure: true
          targetPort: 3000

commands:
  - id: server-start
    exec:
      component: devtools
      commandLine: |
        . $NVM_DIR/nvm.sh && nvm install && nvm use && cd /projects/nanitoru && npm install &&
        export VITE_HTTPS="false" && export VITE_DOMAIN=".$(echo $CHE_DASHBOARD_URL | cut -d'/' -f3)" && npm run dev